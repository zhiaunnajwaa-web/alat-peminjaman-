<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manajemen Peminjaman Alat</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #dcdcdc;
    }
    h1 {
        color: #333;
        margin-bottom: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        background: #ffffff;
    }
    table th, table td {
        border: 1px solid #a34e4e;
        padding: 10px;
        text-align: center;
    }
    table th {
        background-color: #852323;
    }
    button {
        margin: 5px;
        padding: 8px 12px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    .btn-add { background-color: #28a745; color: white; }
    .btn-edit { background-color: #ffc107; color: black; }
    .btn-delete { background-color: #dc3545; color: white; }
    .btn-detail { background-color: #007bff; color: white; }

    /* Popup Modal */
    .modal {
        display: none;
        position: fixed;
        z-index: 10;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.5);
    }
    .modal-content {
        background-color: #fff;
        margin: 10% auto;
        padding: 20px;
        width: 400px;
        border-radius: 8px;
    }
    .modal-content input, .modal-content select {
        width: 100%;
        padding: 8px;
        margin: 6px 0;
    }
    .close {
        float: right;
        color: red;
        cursor: pointer;
    }
</style>
</head>
<body>

<h1>ðŸ“‹ Manajemen Peminjaman Alat</h1>
<button class="btn-add" onclick="openModal('tambah')">+ Tambah Peminjaman</button>

<table id="tabelPeminjaman">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nama Peminjam</th>
            <th>Perangkat</th>
            <th>Tanggal Pinjam</th>
            <th>Tanggal Kembali</th>
            <th>Status</th>
            <th>Aksi</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<!-- MODAL FORM -->
<div id="modalForm" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h3 id="modalTitle">Tambah Peminjaman</h3>
        <input type="hidden" id="editId">
        <label>Nama Peminjam:</label>
        <input type="text" id="namaPeminjam" placeholder="Nama...">
        <label>Perangkat:</label>
        <input type="text" id="perangkat" placeholder="Nama alat...">
        <label>Tanggal Pinjam:</label>
        <input type="date" id="tglPinjam">
        <label>Tanggal Kembali:</label>
        <input type="date" id="tglKembali">
        <label>Status:</label>
        <select id="status">
            <option value="Dipinjam">Dipinjam</option>
            <option value="Dikembalikan">Dikembalikan</option>
        </select>
        <button class="btn-add" onclick="simpanData()">Simpan</button>
    </div>
</div>

<script>
let data = JSON.parse(localStorage.getItem('peminjamanData')) || [];
let editMode = false;

function renderTable() {
    const tbody = document.querySelector("#tabelPeminjaman tbody");
    tbody.innerHTML = "";
    data.forEach((item, index) => {
        tbody.innerHTML += `
        <tr>
            <td>${item.id}</td>
            <td>${item.nama}</td>
            <td>${item.perangkat}</td>
            <td>${item.pinjam}</td>
            <td>${item.kembali}</td>
            <td>${item.status}</td>
            <td>
                <button class="btn-detail" onclick="lihatDetail(${index})">Detail</button>
                <button class="btn-edit" onclick="editData(${index})">Edit</button>
                <button class="btn-delete" onclick="hapusData(${index})">Hapus</button>
            </td>
        </tr>`;
    });
}

function openModal(mode, index = null) {
    document.getElementById("modalForm").style.display = "block";
    if (mode === "tambah") {
        editMode = false;
        document.getElementById("modalTitle").textContent = "Tambah Peminjaman";
        document.getElementById("namaPeminjam").value = "";
        document.getElementById("perangkat").value = "";
        document.getElementById("tglPinjam").value = "";
        document.getElementById("tglKembali").value = "";
        document.getElementById("status").value = "Dipinjam";
    }
}

function closeModal() {
    document.getElementById("modalForm").style.display = "none";
}

function simpanData() {
    const nama = document.getElementById("namaPeminjam").value;
    const perangkat = document.getElementById("perangkat").value;
    const pinjam = document.getElementById("tglPinjam").value;
    const kembali = document.getElementById("tglKembali").value;
    const status = document.getElementById("status").value;

    if (!nama || !perangkat) {
        alert("Nama dan perangkat wajib diisi!");
        return;
    }

    if (editMode) {
        const id = document.getElementById("editId").value;
        data[id] = { ...data[id], nama, perangkat, pinjam, kembali, status };
    } else {
        data.push({
            id: Date.now(),
            nama, perangkat, pinjam, kembali, status
        });
    }

    localStorage.setItem('peminjamanData', JSON.stringify(data));
    renderTable();
    closeModal();
}

function editData(index) {
    editMode = true;
    const item = data[index];
    document.getElementById("modalTitle").textContent = "Edit Peminjaman";
    document.getElementById("editId").value = index;
    document.getElementById("namaPeminjam").value = item.nama;
    document.getElementById("perangkat").value = item.perangkat;
    document.getElementById("tglPinjam").value = item.pinjam;
    document.getElementById("tglKembali").value = item.kembali;
    document.getElementById("status").value = item.status;
    document.getElementById("modalForm").style.display = "block";
}

function hapusData(index) {
    if (confirm("Yakin ingin menghapus data ini?")) {
        data.splice(index, 1);
        localStorage.setItem('peminjamanData', JSON.stringify(data));
        renderTable();
    }
}

function lihatDetail(index) {
    const item = data[index];
    alert(`ðŸ“‹ Detail Peminjaman:
Nama: ${item.nama}
Perangkat: ${item.perangkat}
Tgl Pinjam: ${item.pinjam}
Tgl Kembali: ${item.kembali}
Status: ${item.status}`);
}

window.onload = renderTable;
</script>

</body>
</html>